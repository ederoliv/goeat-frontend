<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg" href="../../../libraries/assets/goeat-ico.svg">
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../../../libraries/styles/product.css"/>
    <link rel="stylesheet" href="../../../libraries/styles/colors.css"/>
    <link rel="stylesheet" href="../../../libraries/styles/dashboard.css"/>
    <link rel="stylesheet" href="styles/analytics-main.css"/>
    <link rel="stylesheet" href="styles/analytics-sales-timeline-chart.css"/>
    <link rel="stylesheet" href="styles/analytics-products-bestsellers-chart.css"/>
    <link rel="stylesheet" href="styles/analytics-products-categories-chart.css"/>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>Análises - Goeat</title>
  </head>
  <body id="body">
    <div class="container">
      <nav class="navbar">
        <div class="nav_icon" onclick="toggleSidebar()">
          <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
        <div class="navbar__left">
          <p id="userName"></p>
        </div>
        <div class="navbar__right">
          <a href="#" onclick="refreshAnalytics()">
            <i class="fa fa-refresh" aria-hidden="true" title="Atualizar análises"></i>
          </a>
          <a href="#">
            <i class="fa fa-user-circle-o" aria-hidden="true"></i>
          </a>
        </div>
      </nav>

      <main>
        <div class="analytics-container">
          <!-- Cabeçalho da página -->
          <div class="analytics-header">
            <h2>Análises e Relatórios</h2>
            <div class="period-selector">
              <select id="period-select" class="period-select">
                <option value="7">Últimos 7 dias</option>
                <option value="30" selected>Últimos 30 dias</option>
                <option value="90">Últimos 90 dias</option>
                <option value="365">Último ano</option>
              </select>
            </div>
          </div>

          <!-- Cards de métricas resumidas -->
          <div class="metrics-cards">
            <div class="metric-card">
              <div class="metric-header">
                <i class="fa fa-shopping-cart metric-icon"></i>
                <h3>Total de Pedidos</h3>
              </div>
              <div class="metric-value" id="total-orders">
                <span class="loading">...</span>
              </div>
              <div class="metric-change positive" id="orders-change">
                <i class="fa fa-arrow-up"></i>
                <span>+12% vs período anterior</span>
              </div>
            </div>

            <div class="metric-card">
              <div class="metric-header">
                <i class="fa fa-money metric-icon"></i>
                <h3>Faturamento</h3>
              </div>
              <div class="metric-value" id="total-revenue">
                <span class="loading">...</span>
              </div>
              <div class="metric-change positive" id="revenue-change">
                <i class="fa fa-arrow-up"></i>
                <span>+8% vs período anterior</span>
              </div>
            </div>

            <div class="metric-card">
              <div class="metric-header">
                <i class="fa fa-users metric-icon"></i>
                <h3>Clientes Únicos</h3>
              </div>
              <div class="metric-value" id="unique-customers">
                <span class="loading">...</span>
              </div>
              <div class="metric-change positive" id="customers-change">
                <i class="fa fa-arrow-up"></i>
                <span>+15% vs período anterior</span>
              </div>
            </div>

            <div class="metric-card">
              <div class="metric-header">
                <i class="fa fa-star metric-icon"></i>
                <h3>Ticket Médio</h3>
              </div>
              <div class="metric-value" id="average-ticket">
                <span class="loading">...</span>
              </div>
              <div class="metric-change negative" id="ticket-change">
                <i class="fa fa-arrow-down"></i>
                <span>-3% vs período anterior</span>
              </div>
            </div>
          </div>

          <!-- Seção de gráficos -->
          <div class="charts-section">
            <!-- Gráfico principal - Vendas ao longo do tempo -->
            <div class="chart-container sales-timeline-container">
              <div class="chart-header sales-timeline-header">
                <h3>Vendas ao Longo do Tempo</h3>
                <div class="chart-controls sales-timeline-controls">
                  <button class="chart-toggle sales-timeline-toggle active" data-chart="revenue" onclick="toggleSalesTimelineChart('revenue')">Faturamento</button>
                  <button class="chart-toggle sales-timeline-toggle" data-chart="orders" onclick="toggleSalesTimelineChart('orders')">Pedidos</button>
                </div>
              </div>
              <div class="chart-content sales-timeline-content">
                <canvas id="sales-timeline-chart"></canvas>
              </div>
            </div>

            <!-- Gráfico de produtos mais vendidos -->
            <div class="chart-container products-bestsellers-container">
              <div class="chart-header products-bestsellers-header">
                <h3>Produtos Mais Vendidos</h3>
                <div class="chart-controls products-bestsellers-controls">
                  <button class="chart-toggle products-bestsellers-toggle active" onclick="toggleBestsellersView('quantity')">Quantidade</button>
                  <button class="chart-toggle products-bestsellers-toggle" onclick="toggleBestsellersView('revenue')">Faturamento</button>
                </div>
              </div>
              <div class="chart-content products-bestsellers-content">
                <canvas id="products-bestsellers-chart"></canvas>
              </div>
              <div class="bestsellers-metrics">
                <!-- Métricas serão inseridas via JavaScript -->
              </div>
            </div>

            <!-- Gráfico de categorias de produtos -->
            <div class="chart-container products-categories-container">
              <div class="chart-header products-categories-header">
                <h3>Categorias de Produtos</h3>
                <div class="chart-controls products-categories-controls">
                  <button class="chart-toggle products-categories-toggle active" onclick="toggleCategoriesView('revenue')">Faturamento</button>
                  <button class="chart-toggle products-categories-toggle" onclick="toggleCategoriesView('quantity')">Quantidade</button>
                  <button class="chart-toggle products-categories-toggle" onclick="toggleCategoriesView('margin')">Margem</button>
                </div>
              </div>
              <div class="chart-content products-categories-content">
                <div class="products-categories-chart-area">
                  <canvas id="products-categories-chart"></canvas>
                </div>
                <div class="categories-metrics">
                  <!-- Métricas serão inseridas via JavaScript -->
                </div>
                <div class="categories-details">
                  <!-- Detalhes serão inseridos via JavaScript -->
                </div>
              </div>
            </div>
          </div>

          <!-- Tabela de produtos detalhada -->
          <div class="detailed-table">
            <div class="table-header">
              <h3>Desempenho Detalhado dos Produtos</h3>
              <button class="export-button" onclick="exportProductData()">
                <i class="fa fa-download"></i> Exportar
              </button>
            </div>
            <div class="table-container">
              <table id="products-table">
                <thead>
                  <tr>
                    <th>Produto</th>
                    <th>Qtd. Vendida</th>
                    <th>Faturamento</th>
                    <th>% do Total</th>
                    <th>Ticket Médio</th>
                    <th>Trend</th>
                  </tr>
                </thead>
                <tbody id="products-table-body">
                  <!-- Dados serão carregados via JavaScript -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </main>

      <div id="sidebar">
        <div class="sidebar__title">
          <div class="sidebar__img">
            <img src="../../../libraries/assets/goeat-logo.svg" alt="logo" />
          </div>
          <i
            onclick="closeSidebar()"
            class="fa fa-times"
            id="sidebarIcon"
            aria-hidden="true"
          ></i>
        </div>

        <div class="sidebar__menu">
          <div class="sidebar__link">
            <i class="fa fa-search"></i>
            <a class="link-text" href="#">Pesquisar</a>
          </div>
          <div class="sidebar__link">
            <i class="fa fa-home"></i>
            <a class="link-text" href="../acompanhar/index.html">Acompanhar</a>
          </div>
          <div class="sidebar__link">
            <i class="fa fa-calendar-check-o"></i>
            <a class="link-text" href="../history/index.html">Histórico</a>
          </div>
          <div class="sidebar__link">
            <i class="fa fa-money"></i>
            <a class="link-text" href="../finance/index.html">Financeiro</a>
          </div>
          <div class="sidebar__link active_menu_linke">
            <i class="fa fa-pie-chart"></i>
            <a class="link-text" href="../analytics/index.html">Análises</a>
          </div>
          <div class="sidebar__link">
            <i class="fa fa-comments"></i>
            <a class="link-text" href="../support/index.html">Suporte</a>
          </div>
          <div class="sidebar__link">
            <i class="fa fa-wrench"></i>
            <a class="link-text" href="#">Configurações</a>
          </div>
          <div class="sidebar__link">
            <i class="fa fa-archive"></i>
            <a class="link-text" href="../meuProdutos/index.html">Meus produtos</a>
          </div>
          <div class="sidebar__logout">
            <i class="fa fa-power-off"></i>
            <a href="../../loginPartner/index.html">Sair</a>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Chart.js para os gráficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="../../../libraries/scripts/utilities.js"></script>
    <script src="../../../libraries/scripts/routes.js"></script>
    <script src="../../../libraries/scripts/dashboard.js"></script>
    <script src="scripts/analytics-main.js"></script>
    <script src="scripts/analytics-sales-timeline-chart.js"></script>
    <script src="scripts/analytics-products-bestsellers-chart.js"></script>
    <script src="scripts/analytics-products-categories-chart.js"></script>
  </body>
</html>